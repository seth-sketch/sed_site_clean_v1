(function(){'use strict';var P="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 9'><rect width='16' height='9' fill='%23f0f0f0'/></svg>";function G(){return document.getElementById('homeGrid')||document.getElementById('workGrid');}function S(g){var s=document.getElementById('gridSentinel');if(!s){s=document.createElement('div');s.id='gridSentinel';s.style.height='1px';(g.parentNode||document.body).appendChild(s);}return s;}function f(u){return fetch(u,{cache:'no-store'}).then(function(r){if(!r.ok)throw 0;return r.json();});}function load(cb){var b=['/assets/work.json','./assets/work.json','../assets/work.json'];(function n(i){if(i>=b.length)return cb([]);f(b[i]+'?v='+Date.now()).then(function(d){cb(Array.isArray(d)?d:[]);}).catch(function(){n(i+1);});})(0);}function card(it){var t=it.title||'Untitled Project',m=[it.client,it.year,it.role].filter(Boolean).join(' Â· '),c=it.cover||(it.gallery&&it.gallery[0])||P,h=it.slug?('/project.html?slug='+encodeURIComponent(it.slug)):'#';return '<article class="card"><a class="cover" href="'+h+'"><span class="ratio-169"><img loading="lazy" src="'+c+'" alt=""></span></a><div class="footer"><a href="'+h+'">'+t+'</a>'+(m?'<div class="meta">'+m+'</div>':'')+'</div></article>'; }function fall(root){root.addEventListener('error',function(e){var img=e.target&&e.target.tagName==='IMG'?e.target:null;if(!img)return;img.src=P;img.setAttribute('data-ph','1');},true);}function start(list){var g=G();if(!g)return;fall(g);var s=S(g),i=0,STEP=12,l=false,d=false;function more(){if(d||l)return;l=true;var end=Math.min(i+STEP,list.length),html='';for(var k=i;k<end;k++)html+=card(list[k]);i=end;if(html){var tmp=document.createElement('div');tmp.innerHTML=html;while(tmp.firstChild)g.appendChild(tmp.firstChild);}if(i>=list.length)d=true;l=false;}if('IntersectionObserver'in window){var io=new IntersectionObserver(function(ents){for(var j=0;j<ents.length;j++)if(ents[j].isIntersecting)more();},{rootMargin:'0px 0px 300px 0px'});io.observe(s);}else{function on(){var r=s.getBoundingClientRect(),vh=window.innerHeight||document.documentElement.clientHeight;if(r.top<vh+300)more();}window.addEventListener('scroll',on);}more();}function norm(list){for(var i=0;i<list.length;i++){var it=list[i];if(it.cover&&it.cover.charAt(0)!=='/')it.cover='/'+it.cover.replace(/^\/+/,'' );if(it.gallery&&it.gallery.length)for(var j=0;j<it.gallery.length;j++){var x=it.gallery[j];it.gallery[j]=(x.charAt(0)==='/'?x:'/'+x.replace(/^\/+/,''));}}return list;}function init(){load(function(list){start(norm(Array.isArray(list)?list:[]));});}if(document.readyState==='loading')document.addEventListener('DOMContentLoaded',init);else init();})();